---
title: vim 使用技巧（一）- Vim 解决问题的方式
date: 2019-08-29 10:33:30
tags: 
  - vim
  - reading
  - note
  - vim 使用技巧
categories: 读书笔记
---

本质上讲，我们的工作是重复性的。不论是在几个不同的地方做相同的小改动，还是在文档的相似结构间移动，我们都会重复很多操作。凡是可以简化重复性操作的方式，都会成倍地节省我们的时间。

<!--more-->

## 技巧1： 结识  `.` 命令

> `.` 命令可以让我们重复上次的修改

**测试文本**

```bash
$ cat test.txt
Line one
Line two
Line three
Line four
```

`x` 命令会删除光标下的字符，在这种情况下使用 `.` 命令 “重复上次修改” 时，就会让 Vim 删除光标下的字符：

![](https://github.com/Joker764/joker764.github.io/blob/src/images/vim/1-1.png?raw=true)

`>G` 命令会增加从当前行到文档末尾处的缩进层级，如果我们在使用了此命令之后使用了 `.` 命令，那么 “重复上次修改” 会让 vim 增加从当前行到文档末尾的缩进层级：

![](https://github.com/Joker764/joker764.github.io/blob/src/images/vim/1-2.png?raw=true)

`x`， `>` 命令都是在普通模式中执行的命令，不过，我们每次进入插入模式时，也会形成一次修改。从进入插入模式的那一刻起，直至返回普通模式，vim 会记录每一个按键操作。做出这样一个修改后再用 `.` 命令，它会重新执行所有这些按键的操作（参见[技巧 8]()）。

**`.` 是一个微型的宏**

## 技巧2： 不要自我重复

> 对于在行尾添加内容这样常见的操作，如添加 `;`，vim 专门提供了一个专门的命令，可以把两步操作合成一步

**测试文件**

```javascript
var foo = 1
var bar = 'a'
var foobar = foo + bar
```

在每一行的末尾添加分号 `;`

**普通方法**

1. 使用 `$` 到行尾
2. 使用 `a` 在光标之后插入
3. 添加 `;`
4. `Esc` 退出插入模式
5. `j`
6. `$`
7. `.` ： 此时 `.` 代替了三个键（`a` `;` `Esc`） 

**减少不相关的移动**

- 使用 `A` 代替 `$` 和 `a`

![](https://github.com/Joker764/joker764.github.io/blob/src/images/vim/2-1.png?raw=true)

一键移动，另一键操作，真是太完美了！请留意这种应用模式，因为我们即将在更多的例子中看到它的身影。

虽然这一模式对这个简短的例子来说很好用，但它不是万能的。试想一下，如果我们不得不给连续 50 行添加分号，即便每个修改输一次 j. ，看起来也是一项很繁重的工作。跳到[技巧 30]() 可以看到另外一种解决方法。

## 技巧3： 以退为进

> 我们可以用一种常用的 vim 操作习惯在一个字符前后各添加一个空格。乍一看，这种方法比较古怪，不过好处是可以重复

**测试文本**

```javascript
var foo = "method("+argument1+","+argument2+")";
// 需要改变为：
var foo = "method(" + argument1 + "," + argument2+")";
```

![](https://github.com/Joker764/joker764.github.io/blob/src/images/vim/3-1.png?raw=true)

**使移动可重复**

`f{char}` 命令让 vim 查找下一处指定字符出现的位置，如果找到了，就直接把光标移动到那里（详细可见 `:h f`）。因此当我们输入 `f+` 时，光标会直接移到下一个出现 `+` 的位置。我们将会在[技巧 49]()里学到更多关于 `f{char}` 命令的知识。

完成第一处修改后，可以直接重复按 `f+` 去找下一个加号，不过 `;` 命令会重复查找上次 `f` 命令所查找的字符，因此我们不用连续输入 4 次 `f+`，而是只用输入一次，剩下的直接输入 `;` 就好了。

![](https://github.com/Joker764/joker764.github.io/blob/src/images/vim/3-2.png?raw=true)

`s` 命令把两个操作合为一个：它先删除光标下的字符，然后进入插入模式。在删除 `+` 后，我们先输入 ` + ` ，然后退出插入模式。

先退一步，然后前进三步，看起来可能不够直接。但是这样做的最大的好处是：我们可以使用 `.` 命令重复这一修改操作。我们需要做的只是把光标移动到下一个 `+` 处，使用 `.` 命令重复这一操作即可。

## 技巧4： 执行、重复、返回